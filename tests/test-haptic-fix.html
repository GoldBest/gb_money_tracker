<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç Haptic Feedback Fix</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .button:hover {
            background: #0056b3;
        }
        .success { background: #28a745; }
        .warning { background: #ffc107; color: black; }
        .error { background: #dc3545; }
        .info {
            background: #17a2b8;
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ –¢–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è Haptic Feedback</h1>
        
        <div class="info">
            <strong>–ü—Ä–æ–±–ª–µ–º–∞:</strong> –í Telegram Web App –≤–µ—Ä—Å–∏–∏ 6.0 API HapticFeedback –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è.<br>
            <strong>–†–µ—à–µ–Ω–∏–µ:</strong> –î–æ–±–∞–≤–ª–µ–Ω fallback –Ω–∞ –Ω–∞—Ç–∏–≤–Ω—É—é –≤–∏–±—Ä–∞—Ü–∏—é –∏ —É–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫.
        </div>

        <div class="test-section">
            <h3>üì± –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Telegram Web App</h3>
            <div id="telegram-info">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>

        <div class="test-section">
            <h3>üéØ –¢–µ—Å—Ç Haptic Feedback</h3>
            <p>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –≤–∏–±—Ä–∞—Ü–∏–∏:</p>
            
            <button class="button" onclick="testHaptic('light')">–õ–µ–≥–∫–∞—è –≤–∏–±—Ä–∞—Ü–∏—è</button>
            <button class="button" onclick="testHaptic('medium')">–°—Ä–µ–¥–Ω—è—è –≤–∏–±—Ä–∞—Ü–∏—è</button>
            <button class="button" onclick="testHaptic('heavy')">–°–∏–ª—å–Ω–∞—è –≤–∏–±—Ä–∞—Ü–∏—è</button>
            <br>
            <button class="button success" onclick="testHaptic('success')">–£—Å–ø–µ—Ö</button>
            <button class="button warning" onclick="testHaptic('warning')">–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ</button>
            <button class="button error" onclick="testHaptic('error')">–û—à–∏–±–∫–∞</button>
        </div>

        <div class="test-section">
            <h3>üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏</h3>
            <button class="button" onclick="checkSupport()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É</button>
            <div id="support-info"></div>
        </div>

        <div class="test-section">
            <h3>üìù –õ–æ–≥ –æ–ø–µ—Ä–∞—Ü–∏–π</h3>
            <div id="log" class="log"></div>
            <button class="button" onclick="clearLog()">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
        </div>
    </div>

    <script>
        // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–∞—à—É —É—Ç–∏–ª–∏—Ç—É haptic feedback
        const hapticFeedback = {
            isHapticSupported: () => {
                return window.Telegram?.WebApp?.HapticFeedback && 
                       typeof window.Telegram.WebApp.HapticFeedback.impactOccurred === 'function';
            },

            fallbackHaptic: () => {
                if (navigator.vibrate) {
                    navigator.vibrate(50);
                    log('‚úÖ Fallback: –Ω–∞—Ç–∏–≤–Ω–∞—è –≤–∏–±—Ä–∞—Ü–∏—è');
                } else {
                    log('‚ö†Ô∏è Fallback: –≤–∏–±—Ä–∞—Ü–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
                }
            },

            light: () => {
                if (this.isHapticSupported()) {
                    try {
                        window.Telegram.WebApp.HapticFeedback.impactOccurred('light');
                        log('‚úÖ Haptic feedback light');
                    } catch (error) {
                        log('‚ùå Haptic feedback light failed: ' + error.message);
                        this.fallbackHaptic();
                    }
                } else {
                    log('‚ö†Ô∏è Haptic feedback –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback');
                    this.fallbackHaptic();
                }
            },

            medium: () => {
                if (this.isHapticSupported()) {
                    try {
                        window.Telegram.WebApp.HapticFeedback.impactOccurred('medium');
                        log('‚úÖ Haptic feedback medium');
                    } catch (error) {
                        log('‚ùå Haptic feedback medium failed: ' + error.message);
                        this.fallbackHaptic();
                    }
                } else {
                    log('‚ö†Ô∏è Haptic feedback –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback');
                    this.fallbackHaptic();
                }
            },

            heavy: () => {
                if (this.isHapticSupported()) {
                    try {
                        window.Telegram.WebApp.HapticFeedback.impactOccurred('heavy');
                        log('‚úÖ Haptic feedback heavy');
                    } catch (error) {
                        log('‚ùå Haptic feedback heavy failed: ' + error.message);
                        this.fallbackHaptic();
                    }
                } else {
                    log('‚ö†Ô∏è Haptic feedback –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback');
                    this.fallbackHaptic();
                }
            },

            success: () => {
                if (this.isHapticSupported()) {
                    try {
                        window.Telegram.WebApp.HapticFeedback.notificationOccurred('success');
                        log('‚úÖ Haptic feedback success');
                    } catch (error) {
                        log('‚ùå Haptic feedback success failed: ' + error.message);
                        this.fallbackHaptic();
                    }
                } else {
                    log('‚ö†Ô∏è Haptic feedback –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback');
                    this.fallbackHaptic();
                }
            },

            warning: () => {
                if (this.isHapticSupported()) {
                    try {
                        window.Telegram.WebApp.HapticFeedback.notificationOccurred('warning');
                        log('‚úÖ Haptic feedback warning');
                    } catch (error) {
                        log('‚ùå Haptic feedback warning failed: ' + error.message);
                        this.fallbackHaptic();
                    }
                } else {
                    log('‚ö†Ô∏è Haptic feedback –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback');
                    this.fallbackHaptic();
                }
            },

            error: () => {
                if (this.isHapticSupported()) {
                    try {
                        window.Telegram.WebApp.HapticFeedback.notificationOccurred('error');
                        log('‚úÖ Haptic feedback error');
                    } catch (error) {
                        log('‚ùå Haptic feedback error failed: ' + error.message);
                        this.fallbackHaptic();
                    }
                } else {
                    log('‚ö†Ô∏è Haptic feedback –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback');
                    this.fallbackHaptic();
                }
            },

            isSupported: () => this.isHapticSupported(),

            getVersionInfo: () => {
                if (window.Telegram?.WebApp) {
                    return {
                        version: window.Telegram.WebApp.version,
                        platform: window.Telegram.WebApp.platform,
                        hapticSupported: this.isHapticSupported()
                    };
                }
                return null;
            }
        };

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        function testHaptic(type) {
            log(`üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º: ${type}`);
            
            switch(type) {
                case 'light':
                    hapticFeedback.light();
                    break;
                case 'medium':
                    hapticFeedback.medium();
                    break;
                case 'heavy':
                    hapticFeedback.heavy();
                    break;
                case 'success':
                    hapticFeedback.success();
                    break;
                case 'warning':
                    hapticFeedback.warning();
                    break;
                case 'error':
                    hapticFeedback.error();
                    break;
            }
        }

        function checkSupport() {
            const info = hapticFeedback.getVersionInfo();
            const supportDiv = document.getElementById('support-info');
            
            if (info) {
                supportDiv.innerHTML = `
                    <div class="info">
                        <strong>–í–µ—Ä—Å–∏—è:</strong> ${info.version || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}<br>
                        <strong>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:</strong> ${info.platform || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}<br>
                        <strong>Haptic Feedback:</strong> ${info.hapticSupported ? '‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è' : '‚ùå –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è'}
                    </div>
                `;
            } else {
                supportDiv.innerHTML = `
                    <div class="info">
                        <strong>Telegram Web App:</strong> ‚ùå –ù–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω<br>
                        <strong>–†–µ–∂–∏–º:</strong> –ë—Ä–∞—É–∑–µ—Ä (fallback)
                    </div>
                `;
            }
        }

        function log(message) {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.innerHTML += `[${timestamp}] ${message}\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function clearLog() {
            document.getElementById('log').innerHTML = '';
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        window.addEventListener('load', () => {
            // Mock Telegram Web App –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            if (!window.Telegram?.WebApp) {
                window.Telegram = {
                    WebApp: {
                        version: '6.0',
                        platform: 'web',
                        HapticFeedback: null // –°–∏–º—É–ª–∏—Ä—É–µ–º –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
                    }
                };
                log('üîß –°–æ–∑–¥–∞–Ω mock Telegram Web App –≤–µ—Ä—Å–∏–∏ 6.0 –±–µ–∑ HapticFeedback');
            }

            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
            const info = hapticFeedback.getVersionInfo();
            const infoDiv = document.getElementById('telegram-info');
            
            if (info) {
                infoDiv.innerHTML = `
                    <div class="info">
                        <strong>–í–µ—Ä—Å–∏—è:</strong> ${info.version}<br>
                        <strong>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:</strong> ${info.platform}<br>
                        <strong>Haptic Feedback:</strong> ${info.hapticSupported ? '‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è' : '‚ùå –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è'}
                    </div>
                `;
            }

            log('üöÄ –¢–µ—Å—Ç –∑–∞–ø—É—â–µ–Ω');
            log('üí° –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è haptic feedback');
        });
    </script>
</body>
</html>
